@using System
@inject NavigationManager Navigation
@page "/posts/mine"
@attribute [Authorize]
@inject IProfileService ProfileService;

<UsersPost UserId="@MyId" UserName="@MyName"></UsersPost>


@code {
    public string MyId { get; set; }
    public string MyName { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var myProfile = await ProfileService.GetMineAsync();
        if (myProfile is null)
        {
            Navigation.NavigateTo($"/login?returnUrl={Uri.EscapeDataString(Navigation.Uri)}", true);
            return;
        }

        MyId = myProfile.UserId;
        MyName = myProfile.DisplayName;

        StateHasChanged();
    }

}
