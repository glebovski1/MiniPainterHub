@using MiniPainterHub.Common.DTOs
@inject NavigationManager Navigation

<div class="card h-100 shadow-sm">
    <NavLink class="text-decoration-none text-dark" href="@($"/posts/{Post.Id}")">
        @if (!string.IsNullOrEmpty(Post.ImageUrl))
        {
            <img src="@FullImageUrl"
                 class="card-img-top"
                 alt="Post image"
                 style="height: 180px; object-fit: cover;" />
        }
        <div class="card-body">
            <h5 class="card-title">@Post.Title</h5>
            <p class="card-text text-truncate">@Post.Snippet</p>
        </div>
    </NavLink>
    <div class="card-footer d-flex justify-content-between align-items-center">
        <small class="text-muted">
            @Post.AuthorName • @Post.CreatedAt.ToLocalTime().ToString("MMM dd, yyyy")
        </small>
        <div>
            <span class="me-2"><i class="bi bi-chat-left-text"></i> @Post.CommentCount</span>
            <span><i class="bi bi-heart"></i> @Post.LikeCount</span>
        </div>
    </div>
</div>

@code {
    [Parameter] public PostSummaryDto Post { get; set; } = default!;

    private string FullImageUrl =>
      !string.IsNullOrEmpty(Post.ImageUrl) &&
      Post.ImageUrl!.StartsWith("http", StringComparison.OrdinalIgnoreCase)
        ? Post.ImageUrl
        : $"{Navigation.BaseUri.TrimEnd('/')}{Post.ImageUrl}";
}